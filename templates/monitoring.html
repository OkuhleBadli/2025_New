{% extends "base.html" %}

{% block content %}
<h1>Sensor and Equipment Monitoring</h1>
<div id="sensor-data">
    <!-- Environmental sensors -->
    <h2>Environmental Data</h2>
    <p>Temperature: <span id="temperature">--</span> °C</p>
    <p>Gas Level: <span id="gas-level">--</span></p>
    <p>Vibration: <span id="vibration">--</span></p>

    <!-- Equipment health sensors -->
    <h2>Equipment Health</h2>
    <p>Motor Temperature: <span id="motor-temp">--</span> °C</p>
    <p>Vibration Level: <span id="vibration-level">--</span></p>
    <p>Pressure: <span id="pressure">--</span></p>
    <p>Operational Time: <span id="operational-time">--</span> hours</p>

    <!-- Failure alert message -->
    <div id="failure-alert" style="display: none; color: red; font-weight: bold;">
        ⚠️ Equipment Failure Risk Detected! ⚠️
    </div>
</div>

<script>
    function fetchSensorData() {
        fetch('/sensor_data')
            .then(response => response.json())
            .then(data => {
                // Update environmental data
                document.getElementById('temperature').textContent = data.temperature;
                document.getElementById('gas-level').textContent = data.gas_level;
                document.getElementById('vibration').textContent = data.vibration;

                // Update equipment health data
                document.getElementById('motor-temp').textContent = data.motor_temp;
                document.getElementById('vibration-level').textContent = data.vibration_level;
                document.getElementById('pressure').textContent = data.pressure;
                document.getElementById('operational-time').textContent = data.operational_time;

                // Display alert if equipment failure risk is detected
                if (data.failure_alert) {
                    document.getElementById('failure-alert').style.display = 'block';
                } else {
                    document.getElementById('failure-alert').style.display = 'none';
                }
            })
            .catch(error => console.error('Error fetching sensor data:', error));
    }

    // Update sensor data every 5 seconds
    setInterval(fetchSensorData, 5000);

    // Fetch data immediately on load
    fetchSensorData();
</script>
{% endblock %}

